<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.home.quartzapp.batch.repository.BatchRepository">
    <select id="selectBatchInByProcDateAndStatus" resultType="com.home.quartzapp.batch.entity.BatchIn">
        <![CDATA[
        select BATCH_ID,
            BATCH_NAME,
            START_DT,
            END_DT,
            REC_CNT,
            STATUS
        from T_BATCH_IN
        where BATCH_NAME = 'BAT001'
        AND START_DT >= PARSEDATETIME (#{procDate}, 'yyyyMMdd')
        AND START_DT <  PARSEDATETIME (#{procDate}, 'yyyyMMdd')+1
        AND STATUS = #{status}
        ]]>
    </select>

    <update id="updateBatchInStatusByBatchId">
        update T_BATCH_IN
        set    STATUS = #{status}
        where BATCH_ID = #{batchId}
    </update>

    <insert id="insertBatchOut">
        insert into T_BATCH_OUT
            (CREATE_DT, BATCH_ID, START_DT, END_DT, REC_CNT, OUT_CNT)
        values
            (#{item.createDt}, #{item.batchId}, #{item.startDt}, #{item.endDt}, #{item.recCnt}, #{item.outCnt})
    </insert>
</mapper>
